---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.svelte';
import JobTimeline from '../components/JobTimeline.svelte';
import GameCard from '../components/GameCard.svelte';
import AchievementCard from '../components/AchievementCard.svelte';
import { getCollection } from 'astro:content';

const games = await getCollection('games');
const achievements = await getCollection('achievements');

const sortedGames = games.sort((a, b) => 
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

const sortedAchievements = achievements.sort((a, b) => 
  new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);
---

<Layout title="Bartłomiej Gordon — Unity Developer">
  <Hero client:load />
  
  <!-- Job Timeline Section -->
  <JobTimeline client:visible />
  
  <!-- Projects Section -->
  <section id="projects" class="section">
    <div class="container">
      <header class="section-header">
        <h2 class="section-title">Projects</h2>
      </header>
      
      <div class="games-grid">
        {sortedGames.map((game) => (
          <GameCard game={game} client:visible />
        ))}
      </div>
    </div>
  </section>
  
  <!-- Achievements Section -->
  <section id="achievements" class="section section-alt">
    <div class="container">
      <header class="section-header">
        <h2 class="section-title">Achievements</h2>
      </header>
      
      <div class="achievements-grid">
        {sortedAchievements.map((achievement) => (
          <AchievementCard achievement={achievement} client:visible />
        ))}
      </div>
    </div>
  </section>
</Layout>

<style>
  .section {
    padding: 5rem 0;
  }
  
  .section-alt {
    background: var(--bg-secondary);
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
  }
  
  .section-header {
    margin-bottom: 3rem;
  }
  
  .section-title {
    font-family: var(--font-display);
    font-size: 2rem;
    font-weight: 600;
    color: var(--text-primary);
    letter-spacing: -0.02em;
  }
  
  .games-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 1.5rem;
  }
  
  .achievements-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 1.25rem;
  }
  
  @media (max-width: 768px) {
    .games-grid,
    .achievements-grid {
      grid-template-columns: 1fr;
    }
    
    .section {
      padding: 3.5rem 0;
    }
  }
</style>
